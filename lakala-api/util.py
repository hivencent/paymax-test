# -*- coding: utf-8 -*-
import sys
reload(sys) # Python2.5 初始化后会删除 sys.setdefaultencoding 这个方法，我们需要重新载入
sys.setdefaultencoding('utf-8')
from jpype import *
import os
from api.util import PaymaxUtil
from urllib import *


dict = {'signType': 'RSA', 'service': 'PrePaymentOrder', 'charset': '02', 'merchantCert': u'3082036F30820257A00302010202081BFA74B6884A2998300D06092A864886F70D0101050500305B310B300906035504061302636E310B300906035504080C02626A3110300E06035504070C076265696A696E67310F300D060355040A0C064D75726F6E67310B3009060355040B0C024954310F300D06035504030C06726F6F744341301E170D3136303532313032353231315A170D3137303532313032353231315A3064310B300906035504061302636E310B300906035504080C02626A3110300E06035504070C076265696A696E67310F300D060355040A0C064D75726F6E67310B3009060355040B0C0249543118301606035504030C0F38383830353530313532303030303130819F300D06092A864886F70D010101050003818D00308189028181009AC06AA83ACB6EA4408DF54FEB9C8A2DE264B3B64E297030A944A35CC62FB12B8DD95E03D306D65E5DF2351FC1B14B67A68EA41868197A7E78358A28FF8FADDDB3056EEF557030E2D3D06538E9FF9325D56F780C43411EF619DEBB1B545E24DF4DD8CB905BA13473EA79F292264F602A2748B725F6708B584903B99356E66A990203010001A381B13081AE301D0603551D0E04160414E4A53BAA5048C0AF1279BFCA4D202D3BEB60330830818C0603551D23048184308181801407C69254961EB26785D105D969445BF72CF3CCA7A15FA45D305B310B300906035504061302636E310B300906035504080C02626A3110300E06035504070C076265696A696E67310F300D060355040A0C064D75726F6E67310B3009060355040B0C024954310F300D06035504030C06726F6F74434182081BF6C2A9D76A7CF2300D06092A864886F70D010105050003820101007B369FF8B6EDA4254BEB24E9C2C894D86E951BF011735EC1927E8C2F2059B6AF28E8E71C7AA299AFFEB1308A11E91588CAF3DFEDA25A0F43F26A0663C600678D7FC1A7802D7854107045F8CDD01742C12218D557DCBFF62D28974B39A81FA54CB27006F46174DDF9F92EB3DA082F9316228929B3712D0DBC78CA6D99525A216CD3D7B9B49EBBF18A06807FCE4AF1F2C6358A14EAAC9C563E2D1320FA3202249839EECF9C9EE3DC2396A111FD7AE94EF8B56C80ECD0404842AEB8F42B5231711E56E544A063B7AD2957E5DB8E9BF9E39D948FFD16AE8A78019956FB09416F9274CC12596A393A64401583F39A3BC9140C27E757F3A6A81A8A48560A811D27A80D', 'version': '1.0', 'requestId': '01929291029201019', 'clientIP': '127.0.0.1', 'merchantSign': u'1F7B4A88EB4437E6525B68D394C852A90050C87B513A21CB2C7F421BA26FACB79AF97A3F04176BF130787946EB8CEE41EC53799E7F409198287B12F5EA44D5439FC16388BC2C10E4C10E2484172C9D5518CC3359CCA6592CCB82AD1BB872B982D5148C900ED27D548DE0B7DE1EADF73A24E8CCC42B6F5530EE7D781A5366F7E0'}

def dict2zip(dict):
    key = []
    values = []

    for k, v in dict.iteritems():
        key.append(k)
        values.append(v)

    return zip(key,values)


def url_decode(text,str_filter):
    text = text.split("&")
    for i in text:
        if "%s" % str_filter in i:
            i = str(i.split("=")[1])
            # print i
            res = unquote(i)
            return res
        else:continue

def sign_jar(jsonDict,sign,passwd):
    # assert isinstance(jsonDict,dict)


    # 引入java程序中的类.路径应该是项目中的package包路径
    testPkg = JPackage('test')  # 取得包
    Test = testPkg.RequestUtil  # 取得类
    t = Test()  # 创建Test实例

    # 调用加密
    jsonStr = str(jsonDict)
    hashTable = t.parseJSON2Map(jsonStr,sign,passwd)
    merchantCert = hashTable['merchantCert']
    merchantSign = hashTable['merchantSign']

    # 返回的加密串
    jsonDict["merchantSign"] = merchantSign
    jsonDict["merchantCert"] = merchantCert
    return jsonDict
